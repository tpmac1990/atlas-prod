(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[29],{

/***/ "./src/components/detail/edit/HolderEdit.js":
/*!**************************************************!*\
  !*** ./src/components/detail/edit/HolderEdit.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-redux */ \"./node_modules/react-redux/es/index.js\");\n/* harmony import */ var _redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../redux */ \"./src/redux/index.js\");\n/* harmony import */ var _ItemsManyDropdownAddMulti__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ItemsManyDropdownAddMulti */ \"./src/components/detail/edit/ItemsManyDropdownAddMulti.js\");\n/* harmony import */ var _buildEditDictionary__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./buildEditDictionary */ \"./src/components/detail/edit/buildEditDictionary.js\");\n/* harmony import */ var _EditTitleComponent__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./EditTitleComponent */ \"./src/components/detail/edit/EditTitleComponent.js\");\n/* harmony import */ var _reusable_hooks_useViewportStyle__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../reusable/hooks/useViewportStyle */ \"./src/components/reusable/hooks/useViewportStyle.js\");\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/react-router-dom/esm/react-router-dom.js\");\n/* harmony import */ var _editConfigs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./editConfigs */ \"./src/components/detail/edit/editConfigs.js\");\n\n\n\n\n\n\n\n\n\n\n\nvar HolderEdit = function HolderEdit(_ref) {\n  var match = _ref.match;\n  var id = match.params.id;\n  var dispatch = Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useDispatch\"])();\n\n  var _useRouteMatch = Object(react_router_dom__WEBPACK_IMPORTED_MODULE_7__[\"useRouteMatch\"])(),\n      url = _useRouteMatch.url;\n\n  var history = Object(react_router_dom__WEBPACK_IMPORTED_MODULE_7__[\"useHistory\"])();\n\n  var _useSelector = Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useSelector\"])(function (state) {\n    return state.detailSelection;\n  }),\n      value = _useSelector.holder;\n\n  var _useSelector2 = Object(react_redux__WEBPACK_IMPORTED_MODULE_1__[\"useSelector\"])(function (state) {\n    return state.dataEdit;\n  }),\n      holders = _useSelector2.holders,\n      holder_result = _useSelector2.holder_result;\n\n  var groups = _editConfigs__WEBPACK_IMPORTED_MODULE_8__[\"holder_objs\"].groups,\n      columns = _editConfigs__WEBPACK_IMPORTED_MODULE_8__[\"holder_objs\"].columns,\n      multis = _editConfigs__WEBPACK_IMPORTED_MODULE_8__[\"holder_objs\"].multis;\n  var parentSelect = groups.parentSelect,\n      subsidiarySelect = groups.subsidiarySelect,\n      listedSelect = groups.listedSelect;\n  var relatedMulti = multis.relatedMulti,\n      listedMulti = multis.listedMulti;\n\n  var _useViewportStyle = Object(_reusable_hooks_useViewportStyle__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(),\n      viewportStyle = _useViewportStyle.viewportStyle;\n\n  var is_large = ['tv', 'desktop', 'laptop'].includes(viewportStyle); // get the site data when the id changes    \n\n  Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(function () {\n    // get the data to display on the page\n    dispatch(Object(_redux__WEBPACK_IMPORTED_MODULE_2__[\"getHolderData\"])(id));\n  }, [id]); // format the data ready for the post api, then send post request if updates have been made.\n\n  var FormHandler = function FormHandler(e) {\n    e.preventDefault();\n    var dict = Object(_buildEditDictionary__WEBPACK_IMPORTED_MODULE_4__[\"buildEditDictionary\"])(holders, value, columns, id);\n\n    if (dict['changes']) {\n      dispatch(Object(_redux__WEBPACK_IMPORTED_MODULE_2__[\"postSiteUpdates\"])({\n        id: id,\n        dict: dict,\n        endpoint: 'holder'\n      }));\n    } else {\n      window.scrollTo(0, 0);\n      dispatch(Object(_redux__WEBPACK_IMPORTED_MODULE_2__[\"setPopupMessage\"])({\n        message: 'No changes were made',\n        type: 'warning',\n        style: 'warning-edit'\n      }));\n    }\n  };\n\n  Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(function () {\n    var success = holder_result.success,\n        msg = holder_result.msg;\n\n    if (success) {\n      // removing the 'edit/' from the url will direct the page pack to the detail page\n      history.push(url.replace('edit/', '')); // This sets the outcome back to null. \n\n      dispatch(Object(_redux__WEBPACK_IMPORTED_MODULE_2__[\"resetApiOutcome\"])('holder_result'));\n      window.scrollTo(0, 0);\n      dispatch(Object(_redux__WEBPACK_IMPORTED_MODULE_2__[\"setPopupMessage\"])({\n        message: \"Holder \".concat(msg, \" updated successfully\"),\n        type: 'success',\n        style: 'success-edit'\n      }));\n    }\n  }, [holder_result]);\n\n  if (value === null) {\n    return null;\n  } else {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"edit-page\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_EditTitleComponent__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n      title: value.holder_name,\n      index: id\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"form\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_ItemsManyDropdownAddMulti__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n      is_large: is_large,\n      header: \"Parents\",\n      datagroup: \"holders\",\n      values: value.parent_company,\n      has_input: false,\n      columns: relatedMulti,\n      dropdown_dict: parentSelect\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_ItemsManyDropdownAddMulti__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n      is_large: is_large,\n      header: \"Subsidiaries\",\n      datagroup: \"holders\",\n      values: value.subsidiaries,\n      has_input: false,\n      columns: relatedMulti,\n      dropdown_dict: subsidiarySelect\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_ItemsManyDropdownAddMulti__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n      is_large: is_large,\n      header: \"Listed\",\n      datagroup: \"holders\",\n      values: value.listed_simple,\n      has_input: true,\n      columns: listedMulti,\n      dropdown_dict: listedSelect\n    }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn-c5 edit-submit-btn\",\n      onClick: FormHandler\n    }, \"Submit\")));\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (HolderEdit);\n\n//# sourceURL=webpack:///./src/components/detail/edit/HolderEdit.js?");

/***/ })

}]);